price_estimate = predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06"))))
sprintf("The estimated stock price is %", price_estimate)
sh = sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model = lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate = predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06"))))
sprintf("The estimated stock price is % s", price_estimate)
sh = sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model = lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate = round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
sprintf("The estimated stock price is % s", price_estimate)
sh = sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model = lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate = round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
sprintf("The estimated stock price is $% s", price_estimate)
sh = sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model = lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate = round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
sprintf("The estimated stock price is $% s.", price_estimate)
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
sh <- read_csv("stock_csv\\SOUN.csv")
sh
suppressMessages({
ggplot(sh, aes(x=Date, y=`Adj Close`)) + geom_line(color="blue") + labs(title="Sound Hound Stock Price is Highly Volatile",x="Date", y="Adjusted Close Price") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + scale_y_continuous(breaks=seq(0, 14, 2), labels = seq(0, 14, 2)) + geom_smooth(method = 'lm', colour='red')
})
sh = sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model = lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate = round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
sprintf("The estimated stock price is $% s.", price_estimate)
suppressMessages({
ggplot(sh, aes(x=Date, y=`Adj Close`)) + geom_line(color="blue") + labs(title="Sound Hound Stock Price is Highly Volatile",x="Date", y="Adjusted Close Price") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + scale_y_continuous(breaks=seq(0, 14, 2), labels = seq(0, 14, 2)) + geom_smooth(method = 'lm', colour='red')
})
suppressMessages({
ggplot(sh, aes(x=Date, y=`Adj Close`)) + geom_line(color="blue") + labs(title="Sound Hound Stock Price is Highly Volatile",x="Date", y="Adjusted Close Price") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + scale_y_continuous(breaks=seq(0, 14, 2), labels = seq(0, 14, 2)) + geom_smooth(method = 'lm', colour='red')
})
knitr::opts_chunk$set(echo = FALSE)
sh = sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
sh = sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
sh <- read_csv("stock_csv\\SOUN.csv")
sh
suppressMessages({
ggplot(sh, aes(x=Date, y=`Adj Close`)) + geom_line(color="blue") + labs(title="Sound Hound Stock Price is Highly Volatile",x="Date", y="Adjusted Close Price") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + scale_y_continuous(breaks=seq(0, 14, 2), labels = seq(0, 14, 2)) + geom_smooth(method = 'lm', colour='red')
})
sh = sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model = lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate = round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price = sh[sh['Date'] == as.Date["2024-05-06"],"Adj Close"]
sh = sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model = lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate = round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price = sh[sh['Date'] == as.Date("2024-05-06"),"Adj Close"]
sh = sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model = lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate = round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price = sh[sh['Date'] == as.Date("2024-05-06"),["Adj Close"]]
sh = sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model = lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate = round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price = sh[sh['Date'] == as.Date("2024-05-06"),]
sh = sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model = lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate = round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price = sh[sh['Date'] == as.Date("2024-05-06"),]
sh = sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model = lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate = round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price = sh['Date' == as.Date("2024-05-06"),]
sh = sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model = lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate = round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price = sh[['Date'] == as.Date("2024-05-06"),]
sh = sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model = lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate = round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price = sh[['Date'] == as.Date("2024-05-06"),]
sh = sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model = lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate = round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price = sh[sh['Date'] == as.Date("2024-05-06"),]
a=1
a
sh <- sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model <- lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate <- round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price <- sh[sh['Date'] == as.Date("2024-05-06"),]
sh <- sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model <- lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate <- round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price <- sh[sh['Date_Numeric'] == as.numeric(as.Date("2024-05-06")),]
difference <- price_estimate - curr_price
sh <- sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model <- lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate <- round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price <- sh[sh['Date_Numeric'] == as.numeric(as.Date("2024-05-06")),"Adj Close"]
difference <- price_estimate - curr_price
comparison <- if(price_estimate > curr_price) "greater" else "lesser"
sprintf("The estimated stock price is $% s.", price_estimate)
sprintf("This estimate is % s % s than the true price % s.", )
sh <- sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model <- lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate <- round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price <- sh[sh['Date_Numeric'] == as.numeric(as.Date("2024-05-06")),"Adj Close"]
difference <- price_estimate - curr_price
comparison <- if(price_estimate > curr_price) "greater" else "lesser"
sprintf("The estimated stock price is $% s.", price_estimate)
sprintf("This estimate is % s % s than the true price % s.", difference, comparison, curr_price)
sh <- sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model <- lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate <- round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price <- sh[sh['Date_Numeric'] == as.numeric(as.Date("2024-05-06")),"Adj Close"]
difference <- price_estimate - curr_price
comparison <- if(price_estimate > curr_price) "greater" else "lesser"
sprintf("The estimated stock price is $% s.", price_estimate)
sprintf("This estimate is $% s % s than the true price % s.", difference, comparison, curr_price)
sh <- sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model <- lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate <- round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price <- sh[sh['Date_Numeric'] == as.numeric(as.Date("2024-05-06")),"Adj Close"]
difference <- abs(price_estimate - curr_price)
comparison <- if(price_estimate > curr_price) "greater" else "lesser"
sprintf("The estimated stock price is $% s.", price_estimate)
sprintf("This estimate is $% s % s than the true price % s.", difference, comparison, curr_price)
sh <- sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model <- lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate <- round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price <- sh[sh['Date_Numeric'] == as.numeric(as.Date("2024-05-06")),"Adj Close"]
difference <- abs(price_estimate - curr_price)
comparison <- if(price_estimate > curr_price) "greater" else "less"
sprintf("The estimated stock price is $% s.", price_estimate)
sprintf("This estimate is $% s % s than the true price % s.", difference, comparison, curr_price)
sh <- sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model <- lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate <- round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price <- sh[sh['Date_Numeric'] == as.numeric(as.Date("2024-05-06")),"Adj Close"]
difference <- abs(price_estimate - curr_price)
comparison <- if(price_estimate > curr_price) "greater" else "less"
sprintf("The estimated stock price is $% s.", price_estimate)
sprintf("This estimate is $% s % s than the true price $% s.", difference, comparison, curr_price)
sh <- sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model <- lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate <- round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price <- sh[sh['Date_Numeric'] == as.numeric(as.Date("2024-05-06")),"Adj Close"]
difference <- abs(price_estimate - curr_price)
comparison <- if(price_estimate > curr_price) "greater" else "less"
sprintf("The estimated stock price is $% s.", price_estimate)
sprintf("This estimate is $% s % s than the true price $% s.", difference, comparison, curr_price)
print(5)
sh <- sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model <- lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate <- round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price <- sh[sh['Date_Numeric'] == as.numeric(as.Date("2024-05-06")),"Adj Close"]
difference <- abs(price_estimate - curr_price)
comparison <- if(price_estimate > curr_price) "greater" else "less"
sprintf("The estimated stock price is $% s.", price_estimate)
sprintf("This estimate is $% s % s than the true price $% s.", difference, comparison, curr_price)
ggplot(sh, aes(x=Date, y=`Adj Close`)) + geom_line(color="blue") + labs(title="Sound Hound Stock Price is Highly Volatile",x="Date", y="Volume") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + scale_y_continuous(breaks=seq(0, 14, 2), labels = seq(0, 14, 2)) + geom_smooth(method = 'lm', colour='red')
ggplot(sh, aes(x=Date, y=`Adj Close`)) + geom_line(color="blue") + labs(title="Sound Hound Stock Price is Highly Volatile",x="Date", y="Volume") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + scale_y_continuous(breaks=seq(0, 14, 2), labels = seq(0, 14, 2)) + geom_smooth(method = 'lm', colour='red')
suppressMessages({
ggplot(sh, aes(x=Date, y=`Adj Close`)) + geom_line(color="blue") + labs(title="Sound Hound Stock Price is Highly Volatile",x="Date", y="Adjusted Close Price") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + scale_y_continuous(breaks=seq(0, 14, 2), labels = seq(0, 14, 2)) + geom_smooth(method = 'lm', colour='red')
})
ggplot(sh, aes(x=Date, y=`Volume`)) + geom_line(color="blue") + labs(title="Sound Hound Stock Price is Highly Volatile",x="Date", y="Volume") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + scale_y_continuous(breaks=seq(0, 14, 2), labels = seq(0, 14, 2)) + geom_smooth(method = 'lm', colour='red')
ggplot(sh, aes(x=Date, y=`Volume`)) + geom_line(color="blue") + labs(title="Trading Volume Spiked in Recent Months",x="Date", y="Volume") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + scale_y_continuous(breaks=seq(0, 14, 2), labels = seq(0, 14, 2)) + geom_smooth(method = 'lm', colour='red')
ggplot(sh, aes(x=Date, y=`Volume`)) + geom_line(color="blue") + labs(title="Trading Volume Spiked in Recent Months",x="Date", y="Volume") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + scale_y_continuous(breaks=seq(0, 1004, 2), labels = seq(0, 14, 2)) + geom_smooth(method = 'lm', colour='red')
ggplot(sh, aes(x=Date, y=`Volume`)) + geom_line(color="blue") + labs(title="Trading Volume Spiked in Recent Months",x="Date", y="Volume") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + scale_y_continuous(breaks=seq(0, 100, 2), labels = seq(0, 14, 2)) + geom_smooth(method = 'lm', colour='red')
ggplot(sh, aes(x=Date, y=`Volume`)) + geom_line(color="blue") + labs(title="Trading Volume Spiked in Recent Months",x="Date", y="Volume") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + scale_y_continuous(breaks=seq(0, 100, 2), labels = seq(0, 100, 2)) + geom_smooth(method = 'lm', colour='red')
ggplot(sh, aes(x=Date, y=`Volume`)) + geom_line(color="blue") + labs(title="Trading Volume Spiked in Recent Months",x="Date", y="Volume") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + geom_smooth(method = 'lm', colour='red')
ggplot(sh, aes(x=Date, y=`Volume`)) + geom_line(color="blue") + labs(title="Trading Volume Spiked in Recent Months",x="Date", y="Volume") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + geom_smooth(method = 'lm', colour='red')
IQR = IQR(sh["Volume"])
IQR = IQR(sh["Volume"], na.rm=FALSE, type=7)
IQR = IQR(sh["Volume"], na.rm=FALSE, type=7)
IQR = IQR(sh["Volume"], na.rm=FALSE, type=7)
IQR = IQR(sh["Volume"], na.rm=FALSE, type=7)
IQR = IQR(sh["Volume"], na.rm=FALSE, type=7)
IQR = IQR(sh["Volume"], na.rm=FALSE, type=7)
IQR = IQR(sh["Volume"], na.rm=FALSE, type=7)
sh["Volume"]
IQR = IQR(sh["Volume"], na.rm=FALSE, type=7)
IQR = IQR(as.numeric(sh["Volume"]), na.rm=FALSE, type=7)
IQR = IQR(as.numeric(sh["Volume"]), na.rm=FALSE, type=7)
IQR = IQR(as.numeric(sh["Volume"]), na.rm=FALSE, type=7)
IQR = IQR(c(1:10), na.rm=FALSE, type=7)
IQR = IQR(as.numeric(sh["Volume"]), na.rm=FALSE, type=7)
IQR = IQR(sh["Volume"], na.rm=FALSE, type=7)
as.numeric(sh["Volume"])
as.numeric(sh["Volume"])
as.numeric(sh["Volume"])
as.numeric(sh["Volume"])
as.numeric(sh["Volume"])
as.numeric(sh["Volume"])
as.numeric(sh["Volume"])
as.numeric(sh["Volume"])
as.numeric(sh["Volume"])
IQR = IQR(as.numeric(unlist(sh["Volume"])), na.rm=FALSE, type=7)
IQR = IQR(as.numeric(unlist(sh["Volume"])), na.rm=FALSE, type=7)
IQR
Vol_IQR = IQR(as.numeric(unlist(sh["Volume"])), na.rm=FALSE, type=7)
high_vol = sh[sh["Volume"] > Vol_IQR]
Vol_IQR = IQR(as.numeric(unlist(sh["Volume"])), na.rm=FALSE, type=7)
high_vol = sh[sh["Volume"] > Vol_IQR,]
Vol_IQR <- IQR(as.numeric(unlist(sh["Volume"])), na.rm=FALSE, type=7)
high_vol <- sh[sh["Volume"] > Vol_IQR,]
Vol_IQR <- IQR(as.numeric(unlist(sh["Volume"])), na.rm=FALSE, type=7)
high_vol <- sh[sh["Volume"] > Vol_IQR,]
high_vol
Vol_IQR <- IQR(as.numeric(unlist(sh["Volume"])), na.rm=FALSE, type=7)
high_vol <- sh[sh["Volume"] > Vol_IQR*10,]
high_vol
Vol_IQR <- IQR(as.numeric(unlist(sh["Volume"])), na.rm=FALSE, type=7)
high_vol <- sh[sh["Volume"] > Vol_IQR*10,]
avg_price <- mean(high_vol["Price"])
Vol_IQR <- IQR(as.numeric(unlist(sh["Volume"])), na.rm=FALSE, type=7)
high_vol <- sh[sh["Volume"] > Vol_IQR*10,]
avg_price <- mean(high_vol["Adj Close"])
Vol_IQR <- IQR(as.numeric(unlist(sh["Volume"])), na.rm=FALSE, type=7)
high_vol <- sh[sh["Volume"] > Vol_IQR*10,]
avg_price <- mean(high_vol["Adj Close"])
Vol_IQR <- IQR(as.numeric(unlist(sh["Volume"])), na.rm=FALSE, type=7)
high_vol <- sh[sh["Volume"] > Vol_IQR*10,]
avg_price <- mean(high_vol["Adj Close"])
Vol_IQR <- IQR(as.numeric(unlist(sh["Volume"])), na.rm=FALSE, type=7)
high_vol <- sh[sh["Volume"] > Vol_IQR*10,]
avg_price <- mean(high_vol["Adj Close"])
Vol_IQR <- IQR(as.numeric(unlist(sh["Volume"])), na.rm=FALSE, type=7)
high_vol <- sh[sh["Volume"] > Vol_IQR*10,]
avg_price <- mean(high_vol["Adj Close"])
high_vol["Adj Close"]
mean(high_vol["Adj Close"])
Vol_IQR <- IQR(as.numeric(unlist(sh["Volume"])), na.rm=FALSE, type=7)
high_vol <- sh[sh["Volume"] > Vol_IQR*10,]
avg_price <- mean(unlist(high_vol["Adj Close"]))
mean(unlist(high_vol["Adj Close"]))
Vol_IQR <- IQR(as.numeric(unlist(sh["Volume"])), na.rm=FALSE, type=7)
high_vol <- sh[sh["Volume"] > Vol_IQR*10,]
avg_price <- mean(unlist(high_vol["Adj Close"]))
change <- avg_price - mean(unlist(sh["Adj Close"]))
avg_price - mean(unlist(sh["Adj Close"]))
Vol_IQR <- IQR(as.numeric(unlist(sh["Volume"])), na.rm=FALSE, type=7)
high_vol <- sh[sh["Volume"] > Vol_IQR*10,]
hv_avg_price <- mean(unlist(high_vol["Adj Close"]))
agg_avg_price <- mean(unlist(sh["Adj Close"]))
change <- abs(avg_price - agg_avg_price)
comparison <- if(hv_avg_price > agg_avg_price) "greater" else "less"
sprintf("On high volume trading days (> %s trades), the average share price is %s.", Vol_IQR*10, avg_price)
sprintf("This is $%s %s than the overall average price, which is $%s.", change, comparison, agg_avg_price)
Vol_IQR <- IQR(as.numeric(unlist(sh["Volume"])), na.rm=FALSE, type=7)
high_vol <- sh[sh["Volume"] > Vol_IQR*10,]
hv_avg_price <- round(mean(unlist(high_vol["Adj Close"])), 2)
agg_avg_price <- round(mean(unlist(sh["Adj Close"])), 2)
change <- round(abs(avg_price - agg_avg_price), 2)
comparison <- if(hv_avg_price > agg_avg_price) "greater" else "less"
sprintf("On high volume trading days (> %s trades), the average share price is $%s.", Vol_IQR*10, avg_price)
sprintf("This is $%s %s than the overall average price, which is $%s.", change, comparison, agg_avg_price)
Vol_IQR <- IQR(as.numeric(unlist(sh["Volume"])), na.rm=FALSE, type=7)
high_vol <- sh[sh["Volume"] > Vol_IQR*10,]
hv_avg_price <- round(mean(unlist(high_vol["Adj Close"])), 2)
agg_avg_price <- round(mean(unlist(sh["Adj Close"])), 2)
change <- round(abs(avg_price - agg_avg_price), 2)
comparison <- if(hv_avg_price > agg_avg_price) "greater" else "less"
sprintf("On high volume trading days (> %s trades), the average share price is $%s.", Vol_IQR*10, hv_avg_price)
sprintf("This is $%s %s than the overall average price, which is $%s.", change, comparison, agg_avg_price)
Vol_IQR <- IQR(as.numeric(unlist(sh["Volume"])), na.rm=FALSE, type=7)
high_vol <- sh[sh["Volume"] > Vol_IQR*10,]
hv_avg_price <- round(mean(unlist(high_vol["Adj Close"])), 2)
agg_avg_price <- round(mean(unlist(sh["Adj Close"])), 2)
change <- round(abs(hv_avg_price - agg_avg_price), 2)
comparison <- if(hv_avg_price > agg_avg_price) "greater" else "less"
sprintf("On high volume trading days (> %s trades), the average share price is $%s.", Vol_IQR*10, hv_avg_price)
sprintf("This is $%s %s than the overall average price, which is $%s.", change, comparison, agg_avg_price)
mean(unlist(sh["Open"]))
mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
ggplot(sh) + geom_line(aes(x=Date, y=`Open`), color="blue") + geom_line(aes(x=`Date`, y=`Close`)) labs(title="Trading Volume Spiked in Recent Months",x="Date", y="Share Price") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18))
ggplot(sh) + geom_line(aes(x=Date, y=`Open`), color="blue") + geom_line(aes(x=`Date`, y=`Close`)) labs(title="Trading Volume Spiked in Recent Months",x="Date", y="Share Price") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18))
ggplot(sh) + geom_line(aes(x=Date, y=`Open`), color="blue") + geom_line(aes(x=`Date`, y=`Close`), color = "red") + labs(title="Trading Volume Spiked in Recent Months",x="Date", y="Share Price") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18))
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
ggplot(sh) + geom_line(aes(x=Date, y=`Open`), color="blue") + geom_line(aes(x=`Date`, y=`Close`), color = "red") + labs(title="Trading Volume Spiked in Recent Months",x="Date", y="Share Price") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + legend()
ggplot(sh) + geom_line(aes(x=Date, y=`Open`), color="blue") + geom_line(aes(x=`Date`, y=`Close`), color = "red") + labs(title="Trading Volume Spiked in Recent Months",x="Date", y="Share Price") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + geom_legend()
ggplot(sh) + geom_line(aes(x=Date, y=`Open`), color="blue") + geom_line(aes(x=`Date`, y=`Close`), color = "red") + labs(title="Trading Volume Spiked in Recent Months",x="Date", y="Share Price") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18))
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
open_close_diff <- sh["Close"] - sh["Open"]
ggplot(sh) + geom_boxplot(x=``)
open_close_diff <- sh["Close"] - sh["Open"]
ggplot(sh) + geom_boxplot(x=`open_close_diff`)
open_close_diff <- sh["Close"] - sh["Open"]
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`))
sh <- sh %>% mutate(open_close_diff = sh["Close"] - sh["Open"])s
sh <- sh %>% mutate(open_close_diff = sh["Close"] - sh["Open"])
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`))
sh
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`))
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`))
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"])) + labs(title="Significant Changes Between Open and Close Prices", x = "Daily Price Change")
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`)) + labs(title="Significant Changes Between Open and Close Prices", x = "Daily Price Change")
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`)) + labs(title="Significant Open and Close Price Changes", x = "Daily Price Change")
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`)) + labs(title="Significant Daily Price Changes", x = "Daily Price Change")
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`)) + labs(title="Many Significant Daily Price Changes", x = "Daily Price Change")
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`)) + labs(title="Many Significant Daily Price Changes", x = "Daily Price Change") + scale_y_continuous(breaks=NULL)
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`)) + labs(title="Many Significant Daily Price Changes", x = "Daily Price Change") + scale_y_continuous(breaks=NULL) + scale_x_continuous(breaks=seq(-4, 6, 1))
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`)) + labs(title="Many Significant Daily Price Changes", x = "Daily Price Change") + scale_y_continuous(breaks=NULL) + scale_x_continuous(breaks=seq(-4, 15, 1))
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`)) + labs(title="Many Significant Daily Price Changes", x = "Daily Price Change") + scale_y_continuous(breaks=NULL) + scale_x_continuous(breaks=seq(-4, 15, 1))
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`)) + labs(title="Many Significant Daily Price Changes", x = "Daily Price Change") + scale_y_continuous(breaks=NULL) + scale_x_continuous(breaks=seq(-4, 15, 1))
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`)) + labs(title="Many Significant Daily Price Changes", x = "Daily Price Change") + scale_y_continuous(breaks=NULL) + scale_x_continuous(breaks=seq(-4, 15, 1))
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`)) + labs(title="Many Significant Daily Price Changes", x = "Daily Price Change") + scale_y_continuous(breaks=NULL) + scale_x_continuous(breaks=seq(-4, 0, 1))
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`)) + labs(title="Many Significant Daily Price Changes", x = "Daily Price Change") + scale_y_continuous(breaks=NULL) + scale_x_continuous(breaks=seq(-4, 100, 1))
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`)) + labs(title="Many Significant Daily Price Changes", x = "Daily Price Change") + scale_y_continuous(breaks=NULL) + scale_x_continuous(breaks=seq(-4, 4, 1))
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`)) + labs(title="Many Significant Daily Price Changes", x = "Daily Price Change") + scale_y_continuous(breaks=NULL) + scale_x_continuous(breaks=seq(-4, 4, 1)) + theme(panel.background=element.rect(fill="white"))
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`)) + labs(title="Many Significant Daily Price Changes", x = "Daily Price Change") + scale_y_continuous(breaks=NULL) + scale_x_continuous(breaks=seq(-4, 4, 1)) + theme(panel.background=element_rect(fill="white"))
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`)) + labs(title="Many Significant Daily Price Changes", x = "Daily Price Change") + scale_y_continuous(breaks=NULL) + scale_x_continuous(breaks=seq(-4, 4, 1)) + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"))
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`)) + labs(title="Many Significant Daily Price Changes", x = "Daily Price Change") + scale_y_continuous(breaks=NULL) + scale_x_continuous(breaks=seq(-4, 4, 1)) + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid.major.y = element_line(colour = "grey"))
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`)) + labs(title="Many Significant Daily Price Changes", x = "Daily Price Change") + scale_y_continuous(breaks=NULL) + scale_x_continuous(breaks=seq(-4, 4, 1)) + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid.major.y = element_line(colour = "grey", linetype = "dashed"))
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`)) + labs(title="Many Significant Daily Price Changes", x = "Daily Price Change") + scale_y_continuous(breaks=NULL) + scale_x_continuous(breaks=seq(-4, 4, 1)) + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour = "grey", linetype = "dashed"))
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`)) + labs(title="Many Significant Daily Price Changes", x = "Daily Price Change") + scale_y_continuous(breaks=NULL) + scale_x_continuous(breaks=seq(-4, 4, 1)) + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour = "grey", linetype = "dashed"), plot.title = element_text(size = 18))
day_change <- mean(unlist(sh["Close"])) - mean(unlist(sh["Open"]))
suppressMessages({
timeseries <- ggplot(sh, aes(x=Date, y=`Adj Close`)) + geom_line(color="blue") + labs(title="Sound Hound Stock Price is Highly Volatile",x="Date", y="Adjusted Close Price") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + scale_y_continuous(breaks=seq(0, 14, 2), labels = seq(0, 14, 2)) + geom_smooth(method = 'lm', colour='red')
})
suppressMessages({
timeseries <- ggplot(sh, aes(x=Date, y=`Adj Close`)) + geom_line(color="blue") + labs(title="Sound Hound Stock Price is Highly Volatile",x="Date", y="Adjusted Close Price") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + scale_y_continuous(breaks=seq(0, 14, 2), labels = seq(0, 14, 2)) + geom_smooth(method = 'lm', colour='red')
print(timeseries)
})
sh <- sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model <- lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate <- round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price <- sh[sh['Date_Numeric'] == as.numeric(as.Date("2024-05-06")),"Adj Close"]
difference <- abs(price_estimate - curr_price)
comparison <- if(price_estimate > curr_price) "greater" else "less"
suppressMessages(
sprintf("The estimated stock price is $% s.", price_estimate)
sprintf("This estimate is $% s % s than the true price $% s.", difference, comparison, curr_price)
sh <- sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model <- lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate <- round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price <- sh[sh['Date_Numeric'] == as.numeric(as.Date("2024-05-06")),"Adj Close"]
difference <- abs(price_estimate - curr_price)
comparison <- if(price_estimate > curr_price) "greater" else "less"
suppressMessages({
sprintf("The estimated stock price is $% s.", price_estimate)
sprintf("This estimate is $% s % s than the true price $% s.", difference, comparison, curr_price)
})
sh <- sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model <- lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate <- round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price <- sh[sh['Date_Numeric'] == as.numeric(as.Date("2024-05-06")),"Adj Close"]
difference <- abs(price_estimate - curr_price)
comparison <- if(price_estimate > curr_price) "greater" else "less"
# suppressMessages({
sprintf("The estimated stock price is $% s.", price_estimate)
sprintf("This estimate is $% s % s than the true price $% s.", difference, comparison, curr_price)
# })
volume_timeseries <- ggplot(sh, aes(x=Date, y=`Volume`)) + geom_line(color="blue") + labs(title="Trading Volume Spiked in Recent Months",x="Date", y="Volume") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + geom_smooth(method = 'lm', colour='red')
suppressMessages(print(volume_timeseries))
timeseries <- ggplot(sh, aes(x=Date, y=`Adj Close`)) + geom_line(color="blue") + labs(title="Sound Hound Stock Price is Highly Volatile",x="Date", y="Adjusted Close Price") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + scale_y_continuous(breaks=seq(0, 14, 2), labels = seq(0, 14, 2)) + geom_smooth(method = 'lm', colour='red')
suppressMessages(print(timeseries))
volume_timeseries <- ggplot(sh, aes(x=Date, y=`Volume`)) + geom_line(color="blue") + labs(title="Trading Volume Spike in Recent Months",x="Date", y="Volume") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + geom_smooth(method = 'lm', colour='red')
suppressMessages(print(volume_timeseries))
avg_daily_change <- mean(unlist(sh["Close"] - sh["Open"]))
mean(unlist(sh["Close"] - sh["Open"]))
avg_daily_change <- mean(unlist(sh["Close"] - sh["Open"]))
high_vol_change <- mean(unlist(high_vol["Close"] - high_vol["Open"]))
mean(unlist(high_vol["Close"] - high_vol["Open"]))
avg_daily_change <- mean(unlist(sh["Close"] - sh["Open"]))
high_vol_change <- mean(unlist(high_vol["Close"] - high_vol["Open"]))
comp_avg <- if(avg_daily_change > 0) "up" else "down"
compy_high <- if(high_vol_change > 0) "up" else "down"
sprintf("The stock price goes %s %s on average in a single day.", comp_avg, abs(avg_daily_change))
sprintf("But interestingly, the price goes %s %s on average for days with high trade volume.", compy_high, abs(high_vol_change))
avg_daily_change <- round(mean(unlist(sh["Close"] - sh["Open"])), 2)
high_vol_change <- round(mean(unlist(high_vol["Close"] - high_vol["Open"])), 2)
comp_avg <- if(avg_daily_change > 0) "up" else "down"
compy_high <- if(high_vol_change > 0) "up" else "down"
sprintf("The stock price goes %s $%s on average in a single day.", comp_avg, abs(avg_daily_change))
sprintf("But interestingly, the price goes %s $%s on average for days with high trade volume.", compy_high, abs(high_vol_change))
avg_daily_change <- round(mean(unlist(sh["Close"] - sh["Open"])), 2)
high_vol_change <- round(mean(unlist(high_vol["Close"] - high_vol["Open"])), 2)
comp_avg <- if(avg_daily_change > 0) "up" else "down"
compy_high <- if(high_vol_change > 0) "up" else "down"
sprintf("On average, the stock price goes %s $%s in a single day.", comp_avg, abs(avg_daily_change))
sprintf("But interestingly, the price goes %s $%s on average for days with high trade volume.", compy_high, abs(high_vol_change))
avg_daily_change <- round(mean(unlist(sh["Close"] - sh["Open"])), 2)
round(mean(unlist(sh["Close"]) - mean(sh["Open"])), 2)
high_vol_change <- round(mean(unlist(high_vol["Close"] - high_vol["Open"])), 2)
comp_avg <- if(avg_daily_change > 0) "up" else "down"
compy_high <- if(high_vol_change > 0) "up" else "down"
sprintf("On average, the stock price goes %s $%s in a single day.", comp_avg, abs(avg_daily_change))
sprintf("But interestingly, the price goes %s $%s on average for days with high trade volume.", compy_high, abs(high_vol_change))
avg_daily_change <- round(mean(unlist(sh["Close"] - sh["Open"])), 2)
round(mean(unlist(sh["Close"]) - mean(unlist(sh["Open"]))), 2)
round(mean(unlist(sh["Close"]) - mean(unlist(sh["Open"]))), 2)
avg_daily_change <- round(mean(unlist(sh["Close"] - sh["Open"])), 2)
high_vol_change <- round(mean(unlist(high_vol["Close"] - high_vol["Open"])), 2)
comp_avg <- if(avg_daily_change > 0) "up" else "down"
compy_high <- if(high_vol_change > 0) "up" else "down"
sprintf("On average, the stock price goes %s $%s in a single day.", comp_avg, abs(avg_daily_change))
sprintf("But interestingly, the price goes %s $%s on average for days with high trade volume.", compy_high, abs(high_vol_change))
sh
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
sh <- read_csv("stock_csv\\SOUN.csv")
sh
timeseries <- ggplot(sh, aes(x=Date, y=`Adj Close`)) + geom_line(color="blue") + labs(title="Sound Hound Stock Price is Highly Volatile",x="Date", y="Adjusted Close Price") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + scale_y_continuous(breaks=seq(0, 14, 2), labels = seq(0, 14, 2)) + geom_smooth(method = 'lm', colour='red')
suppressMessages(print(timeseries))
sh <- sh %>% mutate(`Date_Numeric` = as.numeric(`Date`))
model <- lm(`Adj Close`~`Date_Numeric`, sh)
price_estimate <- round(predict(model, newdata=data.frame(`Date_Numeric` = as.numeric(as.Date("2024-05-06")))), 2)
curr_price <- sh[sh['Date_Numeric'] == as.numeric(as.Date("2024-05-06")),"Adj Close"]
difference <- abs(price_estimate - curr_price)
comparison <- if(price_estimate > curr_price) "greater" else "less"
# suppressMessages({
sprintf("The estimated stock price is $% s.", price_estimate)
sprintf("This estimate is $% s % s than the true price $% s.", difference, comparison, curr_price)
# })
volume_timeseries <- ggplot(sh, aes(x=Date, y=`Volume`)) + geom_line(color="blue") + labs(title="Trading Volume Spike in Recent Months",x="Date", y="Volume") + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour="grey", linetype = "dashed"), plot.title = element_text(size=18)) + geom_smooth(method = 'lm', colour='red')
suppressMessages(print(volume_timeseries))
Vol_IQR <- IQR(as.numeric(unlist(sh["Volume"])), na.rm=FALSE, type=7)
high_vol <- sh[sh["Volume"] > Vol_IQR*10,]
hv_avg_price <- round(mean(unlist(high_vol["Adj Close"])), 2)
agg_avg_price <- round(mean(unlist(sh["Adj Close"])), 2)
change <- round(abs(hv_avg_price - agg_avg_price), 2)
comparison <- if(hv_avg_price > agg_avg_price) "greater" else "less"
sprintf("On high volume trading days (> %s trades), the average share price is $%s.", Vol_IQR*10, hv_avg_price)
sprintf("This is $%s %s than the overall average price, which is $%s.", change, comparison, agg_avg_price)
sh <- sh %>% mutate(open_close_diff = `Close` - `Open`)
ggplot(sh) + geom_boxplot(aes(x=`open_close_diff`)) + labs(title="Many Significant Daily Price Changes", x = "Daily Price Change") + scale_y_continuous(breaks=NULL) + scale_x_continuous(breaks=seq(-4, 4, 1)) + theme(panel.background=element_rect(fill="white"), axis.line = element_line(color="black"), panel.grid = element_line(colour = "grey", linetype = "dashed"), plot.title = element_text(size = 18))
avg_daily_change <- round(mean(unlist(sh["Close"] - sh["Open"])), 2)
high_vol_change <- round(mean(unlist(high_vol["Close"] - high_vol["Open"])), 2)
comp_avg <- if(avg_daily_change > 0) "up" else "down"
compy_high <- if(high_vol_change > 0) "up" else "down"
max_diff <- max(sh["Close"] - sh["Open"])
sprintf("On average, the stock price goes %s $%s in a single day.", comp_avg, abs(avg_daily_change))
sprintf("But interestingly, the price goes %s $%s on average for days with high trade volume.", compy_high, abs(high_vol_change))
sprintf("")
max(sh["Close"] - sh["Open"])
avg_daily_change <- round(mean(unlist(sh["Close"] - sh["Open"])), 2)
high_vol_change <- round(mean(unlist(high_vol["Close"] - high_vol["Open"])), 2)
comp_avg <- if(avg_daily_change > 0) "up" else "down"
compy_high <- if(high_vol_change > 0) "up" else "down"
max_diff <- max(sh["Close"] - sh["Open"])
sprintf("On average, the stock price goes %s $%s in a single day.", comp_avg, abs(avg_daily_change))
sprintf("But interestingly, the price goes %s $%s on average for days with high trade volume.", compy_high, abs(high_vol_change))
sprintf("")
avg_daily_change <- round(mean(unlist(sh["Close"] - sh["Open"])), 2)
high_vol_change <- round(mean(unlist(high_vol["Close"] - high_vol["Open"])), 2)
comp_avg <- if(avg_daily_change > 0) "up" else "down"
compy_high <- if(high_vol_change > 0) "up" else "down"
max_diff <- max(sh["Close"] - sh["Open"])
sprintf("On average, the stock price goes %s $%s in a single day.", comp_avg, abs(avg_daily_change))
sprintf("But interestingly, the price goes %s $%s on average for days with high trade volume.", compy_high, abs(high_vol_change))
sprintf("The highest price increase in a single day was $%s", max_diff)
avg_daily_change <- round(mean(unlist(sh["Close"] - sh["Open"])), 2)
high_vol_change <- round(mean(unlist(high_vol["Close"] - high_vol["Open"])), 2)
comp_avg <- if(avg_daily_change > 0) "up" else "down"
compy_high <- if(high_vol_change > 0) "up" else "down"
max_diff <- round(max(sh["Close"] - sh["Open"]), 2)
min_diff <- round(min(sh["Close"] - sh["Open"]), 2)
sprintf("On average, the stock price goes %s $%s in a single day.", comp_avg, abs(avg_daily_change))
sprintf("But interestingly, the price goes %s $%s on average for days with high trade volume.", compy_high, abs(high_vol_change))
sprintf("The highest price increase in a single day was $%s", max_diff)
sprintf("The most a price has fallen in a single day was $%s", abs(min_diff))
avg_daily_change <- round(mean(unlist(sh["Close"] - sh["Open"])), 2)
high_vol_change <- round(mean(unlist(high_vol["Close"] - high_vol["Open"])), 2)
comp_avg <- if(avg_daily_change > 0) "up" else "down"
compy_high <- if(high_vol_change > 0) "up" else "down"
max_diff <- round(max(sh["Close"] - sh["Open"]), 2)
min_diff <- round(min(sh["Close"] - sh["Open"]), 2)
sprintf("On average, the stock price goes %s $%s in a single day.", comp_avg, abs(avg_daily_change))
sprintf("But interestingly, the price goes %s $%s on average for days with high trade volume.", compy_high, abs(high_vol_change))
sprintf("The highest price increase in a single day is $%s", max_diff)
sprintf("The most a price has fallen in a single day is $%s", abs(min_diff))
tinytex::install_tinytex()
tinytex::install_tinytex()
